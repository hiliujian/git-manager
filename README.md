# Git Manager

<div align="center">

**一个轻量级的 Git 可视化管理工具，提供直观的图形界面来管理 Git 仓库的各种操作。**

</div>

## ✨ 特性

- 🎨 **现代化界面** - 精美的深色主题，舒适的视觉体验
- 📁 **文件管理** - 查看、编辑和管理工作区中的变更文件
- 🔍 **差异对比** - 直观的 Side-by-Side 和统一差异视图
- ✍️ **行级编辑** - 支持直接在差异视图中编辑代码
- ↩️ **精细还原** - 支持还原单个文件、代码块（hunk）甚至单行代码
- 💾 **提交管理** - 轻松暂存和提交变更
- 📜 **提交历史** - 浏览完整的提交历史和详细信息
- 🔄 **实时同步** - WebSocket 实时监控文件变化
- 🌿 **分支管理** - 查看当前分支信息
- 🚀 **一键推送** - 快速推送到远程仓库

## 📋 系统要求

- Python 3.7 或更高版本
- Git（已安装并配置）
- 现代浏览器（Chrome、Firefox、Edge、Safari 等）

## 🚀 快速开始

### 1. 克隆项目

```bash
git clone <repository-url>
cd git-manager
```

### 2. 安装依赖（可选）

如果需要 WebSocket 实时同步功能：

```bash
pip install websockets
```

> **注意**：WebSocket 功能是可选的。如果不安装 `websockets` 库，程序仍可正常运行，只是不会有实时文件监控功能。

### 3. 启动服务器

```bash
python3 server.py
```

或在 Windows 上：

```bash
python server.py
```

### 4. 打开浏览器

服务器启动后，在浏览器中访问：

```
http://localhost:7842
```

> **提示**：如果 7842 端口被占用，程序会自动尝试下一个可用端口（7843、7844 等）。

## 📖 使用说明

### 打开仓库

1. 在欢迎页面的输入框中输入 Git 仓库路径
2. 支持以下格式：
   - 绝对路径：`/path/to/your/repo`
   - 相对路径：`./my-project`
   - 用户目录：`~/projects/my-repo`
3. 点击"打开仓库"按钮

### 查看和管理文件

**左侧文件列表**：
- 显示所有有变更的文件
- 文件状态标识：
  - `M` - 已修改（Modified）
  - `A` - 新增（Added）
  - `D` - 已删除（Deleted）
  - `R` - 已重命名（Renamed）
  - `U` - 未跟踪（Untracked）
- 勾选框：选择要暂存/提交的文件
- 文件名颜色：
  - 白色：已跟踪文件
  - 灰色：未跟踪文件（新文件）

**搜索功能**：
- 在文件列表顶部的搜索框中输入关键词
- 实时过滤文件列表

### 查看文件差异

点击文件后，可以：

1. **差异视图**（Diff）：
   - **Split 视图**：并排对比旧版本和新版本
   - **Unified 视图**：统一显示变更内容
   - 绿色背景：新增的行
   - 红色背景：删除的行
   - 蓝色背景：代码块（hunk）标题

2. **完整视图**（Full）：
   - 查看文件的完整内容
   - 支持直接编辑
   - 按 `Ctrl+S`（Mac 上为 `Cmd+S`）保存更改

3. **HEAD 版本**：
   - 查看仓库中已提交的版本

### 编辑和还原操作

**行级编辑**（Split 视图）：
- 点击任意行进行编辑
- 编辑后自动保存
- 支持多行编辑

**还原操作**：
- **还原单行**：在 Split 视图中，点击行号左侧的还原按钮
- **还原多行**：按住 Shift 键选择多行，右键选择"还原选中行"
- **还原代码块**：点击代码块标题右侧的"还原此块"按钮
- **还原整个文件**：在文件列表中右键选择"还原文件"

## 🔧 技术栈

**后端**：
- Python 3（标准库）
- `http.server`：HTTP 服务
- `subprocess`：Git 命令执行
- `websockets`：实时通信（可选）

**前端**：
- 原生 HTML5 + CSS3 + JavaScript
- 无需构建工具，开箱即用
- WebSocket 客户端（实时同步）

## ❓ 常见问题

### Q: 启动时提示 "不是 git 仓库"？

**A**: 确保您输入的路径是一个有效的 Git 仓库（包含 `.git` 目录）。程序会自动向上查找最近的 `.git` 目录。

### Q: WebSocket 警告信息？

**A**: 如果看到 "websockets 库未安装" 的警告，表示缺少 WebSocket 依赖。您可以：
- 安装：`pip install websockets`
- 或者忽略警告，程序仍可正常使用（只是没有实时同步）

### Q: 如何处理中文路径？

**A**: 程序完全支持包含中文的文件路径，确保终端和系统编码设置为 UTF-8。

### Q: 端口被占用怎么办？

**A**: 程序会自动尝试使用下一个可用端口。您也可以在启动时查看控制台输出的实际端口号。

### Q: 差异视图显示异常？

**A**: 请确保：
1. 文件编码为 UTF-8
2. 二进制文件可能无法正确显示差异
3. 刷新页面重新加载

## 🛡️ 安全提示

- ⚠️ 本工具设计为本地开发使用，默认仅监听 `127.0.0.1`
- ⚠️ 不要将此工具暴露到公网环境
- ⚠️ 还原和提交操作不可逆，请谨慎使用
- ⚠️ 建议在重要操作前先备份或创建新分支

## 📝 许可证

MIT License - 详见 LICENSE 文件

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📮 反馈

如有问题或建议，请创建 Issue 或联系维护者。

---

<div align="center">

**⭐ 如果这个项目对您有帮助，请给个 Star！**

Made with ❤️ for Git users

</div>
